{% extends "todo/base.html" %}

{% block title %}Search results{% endblock %}
{% block content_title %}<h2 class="page_title">Search</h2>{% endblock %}

{% block content %}
  <div class="search_results mt-4">
    <div class="row">
      <div class="col-12 col-md-8 offset-md-2 col-lg-8 offset-lg-2">
        <div class="card-body search_results_header">
          <h3 class="mb-1">SEARCH RESULTS</h3>
        </div>
        <div class="card-body search_results_container post_list">
          {% if found_tasks %}
            <h6 class="text-center">{{ found_tasks.count }} search results for term: <strong>{{ query_string }}</strong></h6>

            <ul class="list-group">
              {% for f in found_tasks %}
                <li class="list-group-item search_list_item">
                  <div class="row justify-content-between align-items-center list_item_wrapper">
                    <div class="col-12 col-sm-5 col-md-5 col-lg-4 col-xl-6">
                      <a href="{% url 'todo:task_detail' f.id %}"><h5>{{ f.title }}</h5></a>
                    </div>
                    <div class="col-12 col-sm-7 col-md-7 col-lg-8 col-xl-6">
                      <p>In list: <a href="{% url 'todo:list_detail' f.task_list.id f.task_list.slug %}" class="list_name">{{ f.task_list.name }}</a></p>
                      <p>Assigned to: <strong>{% if f.assigned_to %}{{ f.assigned_to }}{% else %}Anyone{% endif %}</strong></p>
                      <p>Completed: 
                        {% if f.completed %}
                          <b class="completed">
                        {% else %}
                          <b class="not_completed">
                        {% endif %}
                        {{ f.completed|yesno:"Yes,No" }}
                        </b>
                      </p>
                    </div>
                  </div>
                </li>
              {% endfor %}
              <!--<div class="pagination">
                <span class="step-links">
                    {% if found_tasks.has_previous %}
                        <a href="?page=1{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">&laquo; first</a>
                        <a href="?page={{ found_tasks.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">previous</a>
                    {% endif %}

                    <span class="current">
                        Page {{ found_tasks.number }} of {{ found_tasks.paginator.num_pages }}.
                    </span>

                    {% if found_tasks.has_next %}
                        <a href="?page={{ found_tasks.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">next</a>
                        <a href="?page={{ found_tasks.paginator.num_pages }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">last &raquo;</a>
                    {% endif %}
                </span>
            </div>--> 

              <!--<li class="list-group-item search_list_item">
                <div class="row justify-content-between align-items-center">
                  <div class="col-12 col-lg-3">
                    <h5>Lorem Ipsum</h5>
                  </div>
                  <div class="col-12 col-lg-9">
                    <p>In list: <a href="#!" class="list_name">Some List</a></p>
                    <p>Assigned to: <a href="#!" class="user">Sale</a></p>
                    <p>Completed: <b class="completed">Yes</b></p>
                  </div>
                </div>
              </li>
              <li class="list-group-item search_list_item">
                <div class="row justify-content-between align-items-center">
                  <div class="col-12 col-lg-3">
                    <h5>Lorem Ipsum</h5>
                  </div>
                  <div class="col-12 col-lg-9">
                    <p>In list: <a href="#!" class="list_name">Some List</a></p>
                    <p>Assigned to: <a href="#!" class="user">Sale</a></p>
                    <p>Completed: <b class="completed">No</b></p>
                  </div>
                </div>
              </li>-->
            </ul>
            <!-- pagination -->
            <div class="pagination_container mt-4">
              <nav class="mt-5 d-flex d-flex justify-content-center">
                <ul class="pagination">
                  {% if found_tasks.has_previous %}
                    <li class="page-item prev_arrow">
                      <a class="prev arrow" href="?page={{ found_tasks.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" tabindex="-1"></a>
                    </li>
                  {% else %}
                    <li class="page-item prev_arrow custom_disabled">
                      <a class="prev arrow" href="#!" tabindex="-1"></a>
                    </li>
                  {% endif %}

                  {% for i in found_tasks.paginator.page_range %}
                    {% if found_tasks.number == i %}
                      {# <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li> #}
                      <li class="page-item custom_active">
                        <a class="page-link" href="#!">{{ i }}</a>
                      </li>
                    {% else %}
                      {# <li><a href="?page={{ i }}">{{ i }}</a></li> #}
                      <li class="page-item">
                        <a class="page-link" href="?page={{ i }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">{{ i }}</a>
                      </li>
                    {% endif %}
                  {% endfor %}

                  {% if found_tasks.has_next %}
                    <li class="page-item next_arrow">
                      <a class="next arrow" href="?page={{ found_tasks.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"></a>
                    </li>
                  {% else %}
                    <li class="page-item next_arrow custom_disabled">
                      <a class="next arrow" href="#!"></a>
                    </li>
                  {% endif %}                  
                </ul>
              </nav>
            </div>
            <!-- /pagination -->
          {% else %}
            <h2>No results to show, sorry.</h2>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}

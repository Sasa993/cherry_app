{% load static %}
<!DOCTYPE html>
<html>
<head>
	<title>
		Book App - {% block title %} {% endblock %}
	</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<link rel="stylesheet" href="{% static 'css/custom.css' %}" />
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
	{% block other_css %} {% endblock %}
	{% block extrahead %} {% endblock extrahead %}
	{% block extra_js %} {% endblock extra_js %}
	<!-- These JS files need to be inside head tags to make sure that datepicker is being displayed -->
	<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
</head>
<body>
	<div class="container">
		<nav class="navbar-expand-lg navbar navbar-dark bg-dark">
		  <a class="navbar-brand" href="/">Navbar</a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
		    <span class="navbar-toggler-icon"></span>
		  </button>

		  <div class="collapse navbar-collapse" id="navbarSupportedContent">
		    <ul class="navbar-nav mr-auto">
		      <li class="nav-item active">
		        <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
		      </li>
		      <li class="nav-item">
		        <a class="nav-link" href="{% url 'dashboard:dashboard' %}">Dashboard</a>
		      </li>
		    {% if request.user.is_authenticated %}
			      <li class="nav-item">
			      	<a class="nav-link" href="{% url 'todo:lists' %}">All Tasks</a>
			      </li>
			      <li class="nav-item">
			      	<a class="nav-link" href="{% url 'todo:mine' %}">My Tasks</a>
			      </li>
			      <li class="nav-item">
			      	<a class="nav-link" href="{% url 'todo:import_csv' %}">Import CSV</a>
			      </li>
			      <li class="nav-item">
			      	<a class="nav-link" href="{% url 'sendemail:email' %}">Contact Us</a>
			      </li>
			      <form class="form-inline my-2 my-lg-0" action="/todo/search/" method="get" placeholder="Search" aria-label="Search" id="searchForm">
			      		<input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="q" value="" id="q">
		            	{# <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search Tasks</button> #}
		          </form>
			    </ul>
		    	<ul class="navbar-nav">
		    		<li class="nav-item dropdown">
		        		<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		    				Welcome {{ request.user.username }}
		    			</a>
		    			<div class="dropdown-menu" aria-labelledby="navbarDropdown">
			          		<a class="dropdown-item" href="{% url 'admin:index' %}">Profile</a>
			          		<a class="dropdown-item" href="{% url 'account_email' %}">Change E-mail</a>
			          		<a class="dropdown-item" href="{% url 'account_change_password' %}">Change Password</a>
			          		<a class="dropdown-item" href="{% url 'two_factor:profile' %}">Two-Factor Settings</a>
			          		<div class="dropdown-divider"></div>
			         		<a class="dropdown-item" href="{% url 'account_logout' %}">Logout</a>
		        		</div>
		    		</li>
		    	</ul>
		    {% else %}
		    	</ul>
			    <ul class="navbar-nav">
			    	<li class="nav-item">
			    		<a class="nav-link" href="{% url 'two_factor:login' %}">Login</a>
			    	</li>
			    </ul>
		    {% endif %}
		  </div>
		</nav>
	</div>
	<div class="container">
		{% block content %}

		{% endblock %}
	</div>

	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  	
	{% block other_js %} {% endblock %}
	{# Search Bar Implementation #}
	<script>
		$(function() {
			// takes the action/url from the form
			var urlPageLoad = $("#searchForm").attr("action");

			// if the urls contains string "search" it will place "focus" on the input
			if (window.location.href.indexOf("search") > -1) {
				$('#q').focus();
			}
	
			$('#q').click(function(){
				if (window.location.href.indexOf("search") <= -1) {
					location.href = "/todo/search/";
				}
			});

		    $('#q').keyup(function() {
		        $.ajax({
		            type: "GET",
		            url: urlPageLoad,
		            data: {
		                'q' : $('#q').val(),
		                'csrfmiddlewaretoken' : $("input[name=csrfmiddlewaretoken]").val()
		            },
		            dataType: 'html',
		            success: searchSuccess
		        });
		    });
		});

		function searchSuccess(data, textStatus, jqXHR)
		{
		    $('.post_list').html($(data).find('.post_list').html());
		}
	</script>
</body>
</html>